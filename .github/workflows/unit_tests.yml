name: Unit Tests

on: 
  push:
    branches: [main]
  pull_request:
    branches: [main]
 
jobs:
   code_style:
     runs-on: ubuntu-latest
     defaults:
       run:
         shell: bash -l {0}
         
     steps:
       - uses: actions/checkout@v2
       - uses: conda-incubator/setup-miniconda@v2
         with:
           activate-environment: swe4s
           environment-file: environment.yml 
       - run: pycodestyle $(git ls-files "*py") 
   unit_tests:
     runs-on: ubuntu-latest
      steps:
      - name: checkout repo content
        uses: actions/checkout@v2 
      - name: setup python
        uses: actions/setup-python@v2
        with:
          python-version: 3.9.7
      - name: Install Python dependencies
        run: python -m pip install --upgrade pip pandas
      - name: execute py script
        run: |
          cd test/unit
          python -m unittest test_utils
